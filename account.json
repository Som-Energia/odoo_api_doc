{
  "openapi": "3.0.0",
  "info": {
    "title": "Account Management API",
    "description": "API for retrieving and creating accounting accounts in Odoo.\n\n## Authentication\nAll endpoints require API key authentication via the `X-API-Key` header.\n\n## Response Format\nAll responses follow a standard format with `success`, `message`, and optionally `data` or `error_code` fields.\n\n## Multi-Company Behavior\nWhen creating an account, the API automatically creates the same account (without ERP ID) in all other companies where it doesn't exist.\n\n## Error Codes\n- `INVALID_API_KEY`: Authentication failed\n- `RECORD_NOT_FOUND`: Resource not found (404 status)\n- `INVALID_PARAMETERS`: Validation error (400 status)\n- `DUPLICATE_KEY_VALUE`: Duplicate resource (409 status)\n- `INTERNAL_SERVER_ERROR`: Unexpected error (500 status)\n",
    "version": "1.0.0",
    "contact": {
      "name": "Punt Sistemes"
    }
  },
  "servers": [
    {
      "url": "{protocol}://{host}:{port}{basePath}",
      "description": "Personalized Server Configuration",
      "variables": {
        "protocol": {
          "enum": [
            "http",
            "https"
          ],
          "default": "http",
          "description": "Protocol (http or https)"
        },
        "host": {
          "default": "localhost",
          "description": "Server hostname or IP address"
        },
        "port": {
          "default": "8069",
          "description": "Server port number"
        },
        "basePath": {
          "default": "/api/v1",
          "description": "API base path"
        }
      }
    }
  ],
  "security": [
    {
      "ApiKeyAuth": []
    }
  ],
  "components": {
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API key for authentication"
      }
    }
  },
  "paths": {
    "/account/{code}": {
      "get": {
        "summary": "Get Account",
        "description": "Retrieve a specific account by its code.\n\nThe endpoint searches for an exact match of the sanitized account code.\nWhitespace is trimmed from the code before searching.\nReturns 404 if no matching record exists.\n",
        "operationId": "get_account",
        "tags": [
          "Accounts"
        ],
        "parameters": [
          {
            "name": "code",
            "in": "path",
            "required": true,
            "description": "The account code to search for (whitespace will be trimmed)",
            "schema": {
              "type": "string",
              "example": "700000"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Account found successfully",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "Record found successfully",
                  "data": {
                    "odoo_id": 123,
                    "erp_id": 50001,
                    "name": "700000",
                    "company": "My Company"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid, missing, or expired API key",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "error_code": "INVALID_API_KEY",
                  "message": "Invalid or missing API key"
                }
              }
            }
          },
          "404": {
            "description": "Not Found - The account with this code does not exist",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "error_code": "RECORD_NOT_FOUND",
                  "message": "Record not found: 700000"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error - Unexpected error occurred",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "error_code": "INTERNAL_SERVER_ERROR",
                  "message": "An internal server error occurred"
                }
              }
            }
          }
        }
      }
    },
    "/accounts": {
      "post": {
        "summary": "Create Account",
        "description": "Create a new accounting account.\n\nThe endpoint validates the input data and creates a new account record.\nAdditionally, it automatically creates the same account (without ERP ID)\nin all other companies where it doesn't exist.\n\nReturns 409 if a duplicate account already exists.\n",
        "operationId": "create_account",
        "tags": [
          "Accounts"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "example": {
                "name": "Sales Revenue",
                "code": "700000",
                "pnt_erp_id": 50001
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Account created successfully",
            "content": {
              "application/json": {
                "example": {
                  "success": true,
                  "message": "Record created successfully",
                  "data": {
                    "odoo_id": 124,
                    "erp_id": 50001,
                    "values": {
                      "name": "Sales Revenue",
                      "code": "700000"
                    },
                    "new_accounts_by_company": [
                      {
                        "id": 125,
                        "company": "Secondary Company",
                        "pnt_erp_id": false
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid input parameters or validation errors",
            "content": {
              "application/json": {
                "examples": {
                  "missing_field": {
                    "summary": "Missing required field",
                    "value": {
                      "success": false,
                      "error_code": "INVALID_PARAMETERS",
                      "message": "Validation error in request parameters",
                      "validation_errors": [
                        {
                          "type": "missing",
                          "loc": [
                            "code"
                          ],
                          "msg": "Field required"
                        }
                      ]
                    }
                  },
                  "invalid_value": {
                    "summary": "Invalid field value",
                    "value": {
                      "success": false,
                      "error_code": "INVALID_PARAMETERS",
                      "message": "Validation error in request parameters",
                      "validation_errors": [
                        {
                          "type": "string_too_short",
                          "loc": [
                            "name"
                          ],
                          "msg": "String should have at least 1 character",
                          "input": ""
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid, missing, or expired API key",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "error_code": "INVALID_API_KEY",
                  "message": "Invalid or missing API key"
                }
              }
            }
          },
          "409": {
            "description": "Conflict - An account with this ERP ID already exists",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "error_code": "DUPLICATE_KEY_VALUE",
                  "message": "Duplicate key value: duplicate key value violates unique constraint \"account_account_pnt_erp_id_uniq\""
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error - Unexpected error occurred",
            "content": {
              "application/json": {
                "example": {
                  "success": false,
                  "error_code": "INTERNAL_SERVER_ERROR",
                  "message": "An internal server error occurred"
                }
              }
            }
          }
        }
      }
    }
  }
}
